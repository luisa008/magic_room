<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>My first three.js app</title>
		<style>
			body { margin: 0; }
		</style>
	</head>
	<body>
		<!-- Modal Section -->
		<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet"/>
		<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalTitle" aria-hidden="true">
			<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
				<h5 class="modal-title" id="exampleModalTitle">歡迎來到我們的線上藝術展！</h5>
				</div>
				<div class="modal-body" id="exampleModalContent">
				我們在這個展覽裡實作了各種3D物件，<br>
				以及透明、鏡面、霓虹燈等較複雜的材質，<br>
				搭配沈浸式的使用者互動介面。
				<br>
				<br>
				你可以：<br>
				<ul>
					<li>鍵盤敲擊W, S, A, D -> 前後左右移動</li>
					<li>鍵盤敲擊方向鍵 -> 改變頭部視角</li>
					<li>滑鼠點擊「黃色問號懸浮方塊」-> 獲得更多展品資訊</li>
				</ul>
				</div>
				<div class="modal-footer">
				<button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="exampleModalClose">Close</button>
				</div>
			</div>
			</div>
		</div>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.0/jquery.validate.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
		<script>
			$('#exampleModal').modal('show');
			$("#exampleModalClose").click(function() {
				$('#exampleModal').modal('hide');
			});
		</script>
		<!-- Modal Section End-->

		<script src="js/three.js"></script>
		<script type="text/javascript" src="js/dat.gui.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/three@0.140/examples/js/loaders/GLTFLoader.js"></script>
		<!-- <script src="https://cdn.jsdelivr.net/npm/three@0.140/examples/js/controls/OrbitControls.js"></script> -->
		<script src="https://cdn.jsdelivr.net/npm/three@0.140/examples/js/objects/Reflector.js"></script>
		
		<!-- For Unreal Bloom Effect-->
		<script src="https://cdn.jsdelivr.net/npm/three@0.140/examples/js/shaders/CopyShader.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/three@0.140/examples/js/shaders/LuminosityHighPassShader.js"></script>
		<script type="text/js" src="https://cdn.jsdelivr.net/npm/three@0.140/examples/js/shaders/ShaderChunk/tonemapping_pars_fragment.glsl.js"></script>
		
		<script src="https://cdn.jsdelivr.net/npm/three@0.140/examples/js/postprocessing/Pass.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/three@0.140/examples/js/postprocessing/RenderPass.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/three@0.140/examples/js/postprocessing/ShaderPass.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/three@0.140/examples/js/postprocessing/EffectComposer.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/three@0.140/examples/js/postprocessing/UnrealBloomPass.js"></script>
	
		<script type="x-shader/x-vertex" id="vertexshader">
			varying vec2 vUv;
			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}
		</script>

		<script type="x-shader/x-fragment" id="fragmentshader">
			uniform sampler2D baseTexture;
			uniform sampler2D bloomTexture;
			varying vec2 vUv;
			void main() {
				gl_FragColor = ( texture2D( baseTexture, vUv ) + vec4( 1.0 ) * texture2D( bloomTexture, vUv ) );
			}
		</script>

		<script src="index.js"></script>
		<script src="js/control/keyboard.js"></script>
		<script src="js/control/mouse.js"></script>
		<script src="js/postprocess.js"></script>
		<script src="js/pointcloud.js"></script>
		<script src="js/utils.js"></script>
		<script src="js/room1.js"></script>
		<script src="js/room2.js"></script>
		<script src="js/room3.js"></script>
		<script>
			
			function render(){
				requestAnimationFrame( render );
					
				cameraAnimation();
				room1Animate();
				room2Animate();
				room3Animate();
		
				scene.traverse(darkenNonBloomed);
				bloomComposer.render();
				scene.traverse(restoreMaterial);
				finalComposer.render();
				
			}
			
			// function onWindowResize() {
			// 	const width = window.innerWidth;
			// 	const height = window.innerHeight;
			// 	renderer.setSize( width, height );
			// 	bloomComposer.setSize( width, height );
			// 	finalComposer.setSize( width, height );
			// }

			render();
			// window.addEventListener( 'resize', onWindowResize );
		</script>
	</body>
</html>